<style>
.list-group-item:nth-of-type(even) {
    background: #e0e0e0;
}
</style>

<div id="users" class="visible-xs">
	<div class="row">
		<div class="col-md-4">
			<select class="form-control" id="filterOption">
				<option>all</option>
			</select>
		</div>
		<div class="col-md-4">
			<input type="text" class="search" placeholder="Search" />
		</div>
	</div>
	<ul class="list-group list">
		<!--Do something to break this up some -->
		<% @r.each do |r| %>
		<li class="list-group-item">
			<div class="row">
				<div class="col-md-2 pull-right">
					ID <span class="badge"><%= r.id%></span><span class="label label-primary"><%= r.status %></span>
				</div>
				<div class="col-md-8">
					<%= link_to run_detail_path(:id =>r.id), :class => 'btn btn-primary' do %> <span class="glyphicon glyphicon-zoom-in"></span>View Details <% end %>
				</div>
			</div>
			<h4 class="name">Description : <%= r.description %> </h4>

			<div class="row">
				<p class="list-group-item-text">
					<div class="col-md-4">
						<div class="panel panel-default">
							<div class="panel-heading">
								Time info
							</div>
							<div class="panel-body">
								<div class="btn-group btn-group-justified">
									<a class="btn btn-primary btn-block btn-xs">Start</a>
									<a class="btn btn-default btn-block btn-xs"><%= r.created_at.strftime("%m-%d-%y %H:%M") %></a>
								</div>
								<div class="btn-group btn-group-justified">
									<a class="btn btn-primary btn-block btn-xs">Duration</a>
									<a class="btn btn-default btn-block btn-xs">2</a>
								</div>
								<div class="btn-group btn-group-justified">
									<a class="btn btn-primary btn-block btn-xs">Finish</a>
									<a class="btn btn-default btn-block btn-xs"><%= r.updated_at.strftime("%m-%d-%y %H:%M") %></a>
								</div>
							</div>
						</div>
					</div>
					<div class="col-md-4">
						<div class="panel panel-default">
							<div class="panel-heading">
								Stats
							</div>
							<div class="panel-body">
								<div class="btn-group btn-group-justified">
									<a class="btn btn-success btn-block btn-xs">Pass</a>
									<a class="btn btn-default btn-block btn-xs">1</a>
								</div>
								<div class="btn-group btn-group-justified">
									<a class="btn btn-danger btn-block btn-xs">Fail</a>
									<a class="btn btn-default btn-block btn-xs">2</a>
								</div>
								<div class="btn-group btn-group-justified">
									<a class="btn btn-warning btn-block btn-xs">Pending</a>
									<a class="btn btn-default btn-block btn-xs">3</a>
								</div>
							</div>
						</div>
					</div>
					<div class="col-md-4">
						<div class="panel panel-default">
							<div class="panel-heading">
								Platform info
							</div>
							<div class="panel-body">
								<div class="btn-group btn-group-justified">
									<a class="btn btn-primary btn-block btn-xs">OS</a>
									<a class="btn btn-default btn-block btn-xs"><%= r.os %></a>
								</div>
								<div class="btn-group btn-group-justified">
									<a class="btn btn-primary btn-block btn-xs">Browser</a>
									<a class="btn btn-default btn-block btn-xs browser"><%= r.browser %></a>
								</div>
								<div class="btn-group btn-group-justified">
									<a class="btn btn-primary btn-block btn-xs">Version</a>
									<a class="btn btn-default btn-block btn-xs"><%= r.browser_version %></a>
								</div>
							</div>
						</div>
					</div>
				</p>
			</div>
			<% if ! r.notes.empty? %>
			<div class="panel-group" id="accordion">
				<div class="panel panel-default">
					<div class="panel-heading">
						<h4 class="panel-title"><a data-toggle="collapse" data-parent="#accordion" href="#collapseOne">Notes</a></h4>
					</div>
					<div id="collapseOne" class="panel-collapse collapse">
						<div class="panel-body">
							<%= r.notes %>
						</div>
					</div>
				</div>
			</div>
			<% end %>
		</li>
		<% end %>
	</ul>
	<ul class="pagination"></ul>
</div>
<table class="table table-striped table-bordered" id="runs">
	<thead>
		<tr>
			<th>ID</th>
			<th>Desc</th>
			<th>Status</th>
			<th> Pass
			<br/>
			Fail
			<br/>
			Pending
			<br/>
			</th>
			<th>Start</th>
			<th>Duration</th>
			<th>Notes</th>
			<th>OS
			<br/>
			Browser
			<br/>
			Version
			<br/>
			</th>
		</tr>
	</thead>
	<tbody class="list">
		<% @r.each do |r| %>
		<tr>
			<td><%= link_to r.id, run_detail_path(:id =>r.id) %></td>
			<td class="name"><%= r.description %></td>
			<td class="status"><%= r.status %></td>
			<td>
			<div class="row">
				<div class="col-md-1">
					<span class="label label-success">2</span>
				</div>
				<div class="col-md-1">
					<span class="label label-warning">2</span>
				</div>
				<div class="col-md-1">
					<span class="label label-danger">2</span>
				</div>
			</div></td>
			<td> <%= r.created_at.strftime("%m-%d-%y") %>
			<br />
			<%= r.created_at.strftime("%r") %> </td>
			<td><%= r.duration %></td>
			<td>
			<% if ! r.notes.empty? %>
			<button type="button" class="btn btn-default note-details" data-container="body" data-toggle="popover" data-placement="auto" data-content="<%= r.notes.to_s %>">
				<span class="glyphicon glyphicon-pencil"></span>
			</button>
			<% end %>
			</td>
			<td><span class="label label-info"><%= r.os %></span>
			<br/>
			<span class="label label-warning"><%= r.browser %></span>
			<br/>
			<span class="label label-danger"><%= r.browser_version %></span></td>
		</tr>
		<% end %>
	</tbody>
</table>

<script>
	$('.note-details').popover();

	var searchList = ['name', 'status', 'browser']
	$.each(searchList, function(key, value) {
		$('#filterOption').append($('<option>', {
			value : key
		}).text(value));
	});

	var search = searchList
	// Not really working like I'd like it to
	$("#filterOption").change(function() {
		if ($("#filterOption option:selected").text() === "all") {
			// Everyone back to the party
			search = searchList
		} else {
			search = [$("#filterOption option:selected").text()]
		}
	});

	var options = {
		valueNames : search,
		page : 5,
		plugins : [ListPagination({})]
	};

	var userList = new List('users', options); 
</script>
